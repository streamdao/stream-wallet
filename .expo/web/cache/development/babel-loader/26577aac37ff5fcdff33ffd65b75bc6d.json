{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { memo, useState, useEffect } from 'react';\nimport TextInputRN from \"react-native-web/dist/exports/TextInput\";\nimport { Background } from \"../components\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { SubPageHeader } from \"../components\";\nimport { theme } from \"../core/theme\";\nimport TokenCard from \"../components/TokenCard\";\nimport { useStoreState } from \"../hooks/storeHooks\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar SearchTokensScreen = function SearchTokensScreen(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  console.log('route.params', route.params);\n  var pair = route.params.pair;\n  var setPair = route.params.setPair;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var allTokens = useStoreState(function (state) {\n    return state.allTokens;\n  });\n  var ownedTokens = useStoreState(function (state) {\n    return state.ownedTokens;\n  });\n  var firstLoadedTokens = useStoreState(function (state) {\n    return state.firstLoadedTokens;\n  });\n  var activeSubWallet = useStoreState(function (state) {\n    return state.activeSubWallet;\n  });\n\n  var _useState3 = useState(ownedTokens),\n      _useState4 = _slicedToArray(_useState3, 2),\n      filteredTokens = _useState4[0],\n      setFilteredTokens = _useState4[1];\n\n  var searchFilter = function searchFilter() {\n    if (activeSubWallet === 0) {\n      return firstLoadedTokens.filter(function (token) {\n        return token.symbol.toLowerCase().includes(search.toLowerCase()) || token.name.toLowerCase().includes(search.toLowerCase());\n      });\n    }\n\n    return ownedTokens[activeSubWallet].filter(function (token) {\n      return token.symbol.toLowerCase().includes(search.toLowerCase()) || token.name.toLowerCase().includes(search.toLowerCase());\n    });\n  };\n\n  function getDefaultPairToken() {\n    var hasUSDC, usdcToken, symbol1, symbol2, otherToken, otherToken2;\n    return _regeneratorRuntime.async(function getDefaultPairToken$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            hasUSDC = pair.to.pairs.find(function (pair) {\n              return pair.symbol === 'USDC';\n            });\n\n            if (!hasUSDC) {\n              _context.next = 6;\n              break;\n            }\n\n            usdcToken = allTokens.find(function (token) {\n              return token.symbol === 'USDC';\n            });\n            return _context.abrupt(\"return\", usdcToken);\n\n          case 6:\n            symbol1 = pair.to.pairs[0].symbol;\n            symbol2 = pair.to.pairs[1].symbol;\n            otherToken = allTokens.find(function (token) {\n              return token.symbol === symbol1;\n            });\n            otherToken2 = allTokens.find(function (token) {\n              return token.symbol === symbol2;\n            });\n\n            if (!otherToken) {\n              _context.next = 14;\n              break;\n            }\n\n            return _context.abrupt(\"return\", otherToken);\n\n          case 14:\n            return _context.abrupt(\"return\", otherToken2);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  useEffect(function () {\n    setFilteredTokens(searchFilter());\n  }, [search]);\n  return _jsxs(Background, {\n    dismissKeyboard: true,\n    children: [_jsxs(View, {\n      style: {\n        marginBottom: 24\n      },\n      children: [_jsx(SubPageHeader, {\n        backButton: true,\n        children: \"Select From Token\"\n      }), _jsxs(View, {\n        style: {\n          height: 64,\n          borderWidth: 1,\n          borderColor: theme.colors.black_seven,\n          borderRadius: 18,\n          padding: 16,\n          flexDirection: 'row',\n          alignItems: 'center'\n        },\n        children: [_jsx(Image, {\n          source: require(\"../assets/icons/Search.png\"),\n          style: {\n            width: 24,\n            height: 24,\n            marginRight: 8\n          }\n        }), _jsx(TextInputRN, {\n          style: _objectSpread({\n            borderColor: 'black',\n            borderWidth: 0\n          }, theme.fonts.Nunito_Sans.Body_M_Regular),\n          onChangeText: function onChangeText(text) {\n            return setSearch(text);\n          },\n          value: search,\n          placeholder: \"Search token name or symbol\",\n          keyboardType: \"default\"\n        })]\n      })]\n    }), filteredTokens ? _jsx(FlatList, {\n      data: filteredTokens,\n      renderItem: function renderItem(token) {\n        return _jsx(TokenCard, {\n          token: token,\n          onPress: function onPress() {\n            if (pair.to.pairs.find(function (el) {\n              return el.symbol === token.item.symbol;\n            })) {\n              setPair(_objectSpread(_objectSpread({}, pair), {}, {\n                from: token.item\n              }));\n              return navigation.navigate('Trade', {\n                from: token.item,\n                to: pair.to\n              });\n            } else {\n              setPair(_objectSpread(_objectSpread({}, pair), {}, {\n                from: token.item,\n                to: getDefaultPairToken()\n              }));\n              return navigation.navigate('Trade', {\n                from: token.item,\n                to: pair.to\n              });\n            }\n          }\n        });\n      },\n      keyExtractor: function keyExtractor(item) {\n        return item.address;\n      }\n    }) : null]\n  });\n};\n\nexport default memo(SearchTokensScreen);","map":{"version":3,"names":["React","memo","useState","useEffect","Background","SubPageHeader","theme","TokenCard","useStoreState","SearchTokensScreen","navigation","route","console","log","params","pair","setPair","search","setSearch","allTokens","state","ownedTokens","firstLoadedTokens","activeSubWallet","filteredTokens","setFilteredTokens","searchFilter","filter","token","symbol","toLowerCase","includes","name","getDefaultPairToken","hasUSDC","to","pairs","find","usdcToken","symbol1","symbol2","otherToken","otherToken2","marginBottom","height","borderWidth","borderColor","colors","black_seven","borderRadius","padding","flexDirection","alignItems","require","width","marginRight","fonts","Nunito_Sans","Body_M_Regular","text","el","item","from","navigate","address"],"sources":["/workspace/stream-wallet/screens/FromTokenScreen.tsx"],"sourcesContent":["import React, { memo, useState, useEffect } from 'react';\nimport { Text, TouchableOpacity, TextInput as TextInputRN } from 'react-native';\nimport { Background, TextInput } from '../components';\nimport { Navigation } from '../types';\nimport { View, FlatList, Image } from 'react-native';\nimport { Card } from 'react-native-paper';\nimport { SubPageHeader } from '../components';\nimport { theme } from '../core/theme';\nimport TokenCard from '../components/TokenCard';\nimport { useStoreState, useStoreActions } from '../hooks/storeHooks';\n\nimport { TokenListProvider, TokenInfo } from '@solana/spl-token-registry';\nimport Colors from '../constants/Colors';\n\ntype Props = {\n\tnavigation: Navigation;\n\troute: Object;\n};\n\nconst SearchTokensScreen = ({ navigation, route }: Props) => {\n\tconsole.log('route.params', route.params);\n\tconst pair = route.params.pair;\n\tconst setPair = route.params.setPair;\n\tconst [search, setSearch] = useState('');\n\tconst allTokens = useStoreState((state) => state.allTokens);\n\tconst ownedTokens = useStoreState((state) => state.ownedTokens);\n\tconst firstLoadedTokens = useStoreState((state) => state.firstLoadedTokens);\n\tconst activeSubWallet = useStoreState((state) => state.activeSubWallet);\n\n\tconst [filteredTokens, setFilteredTokens] = useState(ownedTokens);\n\n\tconst searchFilter = () => {\n\t\tif (activeSubWallet === 0) {\n\t\t\treturn firstLoadedTokens.filter((token) => {\n\t\t\t\treturn (\n\t\t\t\t\ttoken.symbol.toLowerCase().includes(search.toLowerCase()) ||\n\t\t\t\t\ttoken.name.toLowerCase().includes(search.toLowerCase())\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t\treturn ownedTokens[activeSubWallet].filter((token) => {\n\t\t\treturn (\n\t\t\t\ttoken.symbol.toLowerCase().includes(search.toLowerCase()) ||\n\t\t\t\ttoken.name.toLowerCase().includes(search.toLowerCase())\n\t\t\t);\n\t\t});\n\t};\n\n\tasync function getDefaultPairToken() {\n\t\tconst hasUSDC = pair.to.pairs.find(\n\t\t\t(pair: object) => pair.symbol === 'USDC',\n\t\t);\n\t\tif (hasUSDC) {\n\t\t\tconst usdcToken = allTokens.find(\n\t\t\t\t(token: object) => token.symbol === 'USDC',\n\t\t\t);\n\t\t\treturn usdcToken;\n\t\t} else {\n\t\t\tconst symbol1 = pair.to.pairs[0].symbol;\n\t\t\tconst symbol2 = pair.to.pairs[1].symbol;\n\t\t\tconst otherToken = allTokens.find(\n\t\t\t\t(token: object) => token.symbol === symbol1,\n\t\t\t);\n\t\t\tconst otherToken2 = allTokens.find(\n\t\t\t\t(token: object) => token.symbol === symbol2,\n\t\t\t);\n\t\t\tif (otherToken) {\n\t\t\t\treturn otherToken;\n\t\t\t} else {\n\t\t\t\treturn otherToken2;\n\t\t\t}\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\tsetFilteredTokens(searchFilter());\n\t}, [search]);\n\n\treturn (\n\t\t<Background dismissKeyboard={true}>\n\t\t\t<View style={{ marginBottom: 24 }}>\n\t\t\t\t<SubPageHeader backButton={true}>\n\t\t\t\t\tSelect From Token\n\t\t\t\t</SubPageHeader>\n\n\t\t\t\t<View\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\theight: 64,\n\t\t\t\t\t\tborderWidth: 1,\n\t\t\t\t\t\tborderColor: theme.colors.black_seven,\n\t\t\t\t\t\tborderRadius: 18,\n\t\t\t\t\t\tpadding: 16,\n\t\t\t\t\t\tflexDirection: 'row',\n\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Image\n\t\t\t\t\t\tsource={require('../assets/icons/Search.png')}\n\t\t\t\t\t\tstyle={{ width: 24, height: 24, marginRight: 8 }}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<TextInputRN\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tborderColor: 'black',\n\t\t\t\t\t\t\tborderWidth: 0,\n\t\t\t\t\t\t\t...theme.fonts.Nunito_Sans.Body_M_Regular,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonChangeText={(text: string) => setSearch(text)}\n\t\t\t\t\t\tvalue={search}\n\t\t\t\t\t\tplaceholder=\"Search token name or symbol\"\n\t\t\t\t\t\tkeyboardType=\"default\"\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</View>\n\n\t\t\t{filteredTokens ? (\n\t\t\t\t<FlatList\n\t\t\t\t\tdata={filteredTokens}\n\t\t\t\t\trenderItem={(token) => (\n\t\t\t\t\t\t<TokenCard\n\t\t\t\t\t\t\ttoken={token}\n\t\t\t\t\t\t\tonPress={() => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tpair.to.pairs.find(\n\t\t\t\t\t\t\t\t\t\t(el) => el.symbol === token.item.symbol,\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tsetPair({\n\t\t\t\t\t\t\t\t\t\t...pair,\n\t\t\t\t\t\t\t\t\t\tfrom: token.item,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\treturn navigation.navigate('Trade', {\n\t\t\t\t\t\t\t\t\t\tfrom: token.item,\n\t\t\t\t\t\t\t\t\t\tto: pair.to,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tsetPair({\n\t\t\t\t\t\t\t\t\t\t...pair,\n\t\t\t\t\t\t\t\t\t\tfrom: token.item,\n\t\t\t\t\t\t\t\t\t\tto: getDefaultPairToken(),\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\treturn navigation.navigate('Trade', {\n\t\t\t\t\t\t\t\t\t\tfrom: token.item,\n\t\t\t\t\t\t\t\t\t\tto: pair.to,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\tkeyExtractor={(item) => item.address}\n\t\t\t\t/>\n\t\t\t) : null}\n\t\t</Background>\n\t);\n};\n\nexport default memo(SearchTokensScreen);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}